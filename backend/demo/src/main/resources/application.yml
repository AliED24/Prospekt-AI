spring:
  jackson:
    serialization:
      write-dates-as-timestamps: false
    date-format: dd.MM.yyyy
    time-zone: Europe/Berlin

  datasource:
    url: ${SPRING_DATASOURCE_URL:jdbc:postgresql://localhost:5432/meinedb}
    username: ${SPRING_DATASOURCE_USERNAME:meinuser}
    password: ${SPRING_DATASOURCE_PASSWORD:meinpasswort}
    driver-class-name: org.postgresql.Driver
    hikari:
      connection-init-sql: SELECT 1
      connection-timeout: 30000
      maximum-pool-size: 10
      minimum-idle: 2

  jpa:
    hibernate:
      ddl-auto: update

  servlet:
    multipart:
      max-file-size: 200MB
      max-request-size: 200MB

  ai:
    openai:
      api-key: ${OPENAI_API_KEY}
      base-url: https://api.edeka.digital/ai-dev-models/gen/oai
      model: gemini-2.0-flash
      system-prompt: >
        You are an information extraction system specialized in grocery promotions.
        Return only the following fields exactly as specified, for each product:
        productName,
        storeName,
        brand,
        quantity,
        price,
        originalPrice,
        offerDateStart,
        offerDateEnd,
        Important Extraction Rules:
        If a product has no brand or original price, leave those fields empty.
        All dates must be in format DD.MM.YYYY â€“ e.g. 25.06.2025
        If a product does not have an individual date near it, apply the date-range from the group or page header, or previous
        pages which were sent.
        If no year is present in the date, assume the current year (2025).
        If no end date is shown, take the date-range from previous pages which where sent and dont assume random dates.
        make sure to not consider any dates which are not relevant to the offers. 
        the date-range on many promotions are on some pages not given, just use the date from the previous page.
        the storeName is consistent it does not change on the pages!, use the storeName from the first page.
        the storeName is not on top of a product, it is on the top of the page, just use the storeName from the first page.
        If the AppPrice is not shown, leave it empty.

      user-prompt: >
        Please extract all offers from the file and return them in the specified format.

logging:
  level:
    reactor.netty.http.client: DEBUG
    org.springframework.web.reactive.function.client: DEBUG

server:
  tomcat:
    max-swallow-size: 209715200
    max-http-form-post-size: 209715200
  error:
    include-stacktrace: always
